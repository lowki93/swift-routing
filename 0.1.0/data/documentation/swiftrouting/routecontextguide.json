{"hierarchy":{"paths":[["doc:\/\/SwiftRouting\/documentation\/SwiftRouting"]]},"primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Overview","anchor":"Overview"},{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContext"},{"type":"text","text":" enables communication from child routes back to parent routes. Use it to pass selection results, form data, or completion signals up the navigation hierarchy."}]},{"type":"heading","level":2,"text":"What is RouteContext?","anchor":"What-is-RouteContext"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A "},{"type":"codeVoice","code":"RouteContext"},{"type":"text","text":" is any type conforming to "},{"type":"codeVoice","code":"Hashable & Sendable"},{"type":"text","text":". It acts as a message that can be sent from a child route and received by any ancestor route that registered an observer."}]},{"code":["struct UserSelectionContext: RouteContext {","    let selectedUser: User","}","","struct FormCompletionContext: RouteContext {","    let formData: FormData","    let success: Bool","}"],"type":"codeListing","syntax":"swift"},{"type":"heading","level":2,"text":"Registering Context Observers","anchor":"Registering-Context-Observers"},{"type":"heading","level":3,"text":"Using the View Modifier","anchor":"Using-the-View-Modifier"},{"type":"paragraph","inlineContent":[{"text":"The simplest way to observe contexts is with the ","type":"text"},{"type":"codeVoice","code":"routerContext"},{"text":" modifier:","type":"text"}]},{"code":["struct ParentView: View {","    @State private var selectedUser: User?","    ","    var body: some View {","        ContentView()","            .routerContext(UserSelectionContext.self) { context in","                selectedUser = context.selectedUser","            }","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"heading","level":3,"text":"Using Router Directly","anchor":"Using-Router-Directly"},{"type":"paragraph","inlineContent":[{"type":"text","text":"For ViewModel-driven architectures, register observers via "},{"type":"codeVoice","code":"any RouterModel"},{"type":"text","text":":"}]},{"syntax":"swift","type":"codeListing","code":["@MainActor","final class ParentViewModel: ObservableObject {","    private let router: any RouterModel","","    init(router: any RouterModel) {","        self.router = router","    }","","    func startObservingContext() {","        router.add(context: UserSelectionContext.self) { [weak self] context in","            self?.selectedUser = context.selectedUser","        }","    }","","    func stopObservingContext() {","        router.remove(context: UserSelectionContext.self)","    }","","    deinit {","        stopObservingContext()","    }","}"]},{"type":"aside","name":"Note","content":[{"type":"paragraph","inlineContent":[{"text":"In views, prefer ","type":"text"},{"code":".routerContext(...)","type":"codeVoice"},{"text":" for simple cases.","type":"text"},{"text":" ","type":"text"},{"text":"Use ","type":"text"},{"code":"any RouterModel","type":"codeVoice"},{"text":" in ViewModels when context handling belongs to presentation\/business logic.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Warning: Use weak captures for class references (for example view models) to prevent retain cycles."}]}],"style":"note"},{"type":"heading","text":"Sending Context","anchor":"Sending-Context","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"From a child route, send context using "},{"code":"context(_:)","type":"codeVoice"},{"type":"text","text":" or "},{"code":"terminate(_:)","type":"codeVoice"},{"type":"text","text":":"}]},{"type":"heading","text":"context(_:) - Send Without Navigation","anchor":"context-Send-Without-Navigation","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Sends the context to all observers without affecting navigation:"}]},{"syntax":"swift","type":"codeListing","code":["struct UserPickerView: View {","    @Environment(\\.router) private var router","    let users: [User]","    ","    var body: some View {","        List(users) { user in","            Button(user.name) {","                \/\/ Send context but stay on this screen","                router.context(UserSelectionContext(selectedUser: user))","            }","        }","    }","}"]},{"type":"heading","text":"terminate(_:) - Send and Complete Navigation","anchor":"terminate-Send-and-Complete-Navigation","level":3},{"type":"paragraph","inlineContent":[{"text":"Sends the context, then completes navigation based on router state:","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["struct UserPickerView: View {","    @Environment(\\.router) private var router","    let users: [User]","    ","    var body: some View {","        List(users) { user in","            Button(user.name) {","                \/\/ Send context and complete the current flow","                router.terminate(UserSelectionContext(selectedUser: user))","            }","        }","    }","}"]},{"type":"paragraph","inlineContent":[{"code":"terminate(_:)","type":"codeVoice"},{"text":" will:","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"text":"Execute all matching context observers","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"If a matching local context anchor is found, pop back to that point in the current stack","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Otherwise, close the modal if the router is presented","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Otherwise, go back one step"}]}]}],"type":"orderedList"},{"type":"heading","text":"Context Hierarchy","anchor":"Context-Hierarchy","level":2},{"type":"paragraph","inlineContent":[{"text":"Contexts propagate up through the entire router hierarchy:","type":"text"}]},{"syntax":null,"type":"codeListing","code":["App Router","    └── Tab Router","            └── Home Router (observer registered here)","                    └── List Router","                            └── Detail Router (context sent from here)"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"When context is sent from Detail Router, it reaches the observer in Home Router."}]},{"type":"heading","text":"Removing Observers","anchor":"Removing-Observers","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Observers are automatically removed when their route is popped. You can also remove them manually:"}]},{"syntax":"swift","type":"codeListing","code":["router.remove(context: UserSelectionContext.self)"]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"remove(context:)"},{"type":"text","text":" removes observers for that context type "},{"inlineContent":[{"type":"text","text":"only on the current route"}],"type":"strong"},{"type":"text","text":"."}]},{"type":"heading","text":"Common Patterns","anchor":"Common-Patterns","level":2},{"type":"heading","text":"Selection Flow","anchor":"Selection-Flow","level":3},{"syntax":"swift","type":"codeListing","code":["\/\/ Parent: Start selection","router.push(HomeRoute.userPicker)","","\/\/ Parent: Receive selection",".routerContext(UserSelectionContext.self) { context in","    selectedUser = context.selectedUser","}","","\/\/ Child: Complete selection","router.terminate(UserSelectionContext(selectedUser: user))"]},{"type":"heading","text":"Form Completion","anchor":"Form-Completion","level":3},{"syntax":"swift","type":"codeListing","code":["\/\/ Parent",".routerContext(FormCompletionContext.self) { context in","    if context.success {","        showSuccessMessage()","    }","}","","\/\/ Child (form view)","func submitForm() async {","    let success = await api.submit(formData)","    router.terminate(FormCompletionContext(formData: formData, success: success))","}"]},{"type":"heading","text":"Multi-Step Wizard","anchor":"Multi-Step-Wizard","level":3},{"syntax":"swift","type":"codeListing","code":["struct WizardContext: RouteContext {","    let step: Int","    let data: WizardData","}","","\/\/ Each step sends progress","router.context(WizardContext(step: currentStep, data: collectedData))","","\/\/ Final step terminates","router.terminate(WizardContext(step: finalStep, data: completeData))"]},{"type":"heading","text":"Memory Management","anchor":"Memory-Management","level":2},{"type":"paragraph","inlineContent":[{"text":"Context closures can cause retain cycles. Always use weak references:","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["\/\/ ✅ Correct","router.add(context: MyContext.self) { [weak self] context in","    self?.handleContext(context)","}","","\/\/ ✅ Correct with view model",".routerContext(MyContext.self) { [weak viewModel] context in","    viewModel?.process(context)","}","","\/\/ ❌ Wrong for class references - causes retain cycle","router.add(context: MyContext.self) { context in","    self.handleContext(context)  \/\/ Strong reference to self","}"]}],"kind":"content"}],"variants":[{"paths":["\/documentation\/swiftrouting\/routecontextguide"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContextGuide","interfaceLanguage":"swift"},"sections":[],"metadata":{"modules":[{"name":"SwiftRouting"}],"roleHeading":"Article","role":"article","title":"Route Context"},"schemaVersion":{"minor":3,"major":0,"patch":0},"kind":"article","abstract":[{"type":"text","text":"Learn how to pass data between routes using RouteContext."}],"references":{"doc://SwiftRouting/documentation/SwiftRouting":{"title":"SwiftRouting","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting","abstract":[{"text":"A lightweight, type-safe navigation framework built on top of NavigationStack for SwiftUI.","type":"text"}],"kind":"symbol","role":"collection","url":"\/documentation\/swiftrouting","type":"topic"},"doc://SwiftRouting/documentation/SwiftRouting/RouteContext":{"title":"RouteContext","role":"symbol","kind":"symbol","url":"\/documentation\/swiftrouting\/routecontext","fragments":[{"kind":"keyword","text":"typealias"},{"kind":"text","text":" "},{"kind":"identifier","text":"RouteContext"}],"navigatorTitle":[{"kind":"identifier","text":"RouteContext"}],"type":"topic","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContext","abstract":[{"type":"text","text":"A type that can be used to pass data between routes and trigger navigation flow completions."}]}}}