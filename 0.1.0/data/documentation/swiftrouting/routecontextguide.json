{"metadata":{"title":"Route Context","role":"article","roleHeading":"Article","modules":[{"name":"SwiftRouting"}]},"hierarchy":{"paths":[["doc:\/\/SwiftRouting\/documentation\/SwiftRouting"]]},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContextGuide"},"primaryContentSections":[{"kind":"content","content":[{"level":2,"text":"Overview","type":"heading","anchor":"Overview"},{"inlineContent":[{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContext","isActive":true,"type":"reference"},{"text":" enables communication from child routes back to parent routes. Use it to pass selection results, form data, or completion signals up the navigation hierarchy.","type":"text"}],"type":"paragraph"},{"level":2,"text":"What is RouteContext?","type":"heading","anchor":"What-is-RouteContext"},{"inlineContent":[{"type":"text","text":"A "},{"type":"codeVoice","code":"RouteContext"},{"type":"text","text":" is any type conforming to "},{"type":"codeVoice","code":"Hashable & Sendable"},{"type":"text","text":". It acts as a message that can be sent from a child route and received by any ancestor route that registered an observer."}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["struct UserSelectionContext: RouteContext {","    let selectedUser: User","}","","struct FormCompletionContext: RouteContext {","    let formData: FormData","    let success: Bool","}"]},{"level":2,"text":"Registering Context Observers","type":"heading","anchor":"Registering-Context-Observers"},{"level":3,"text":"Using the View Modifier","type":"heading","anchor":"Using-the-View-Modifier"},{"inlineContent":[{"type":"text","text":"The simplest way to observe contexts is with the "},{"type":"codeVoice","code":"routerContext"},{"type":"text","text":" modifier:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["struct ParentView: View {","    @State private var selectedUser: User?","    ","    var body: some View {","        ContentView()","            .routerContext(UserSelectionContext.self) { context in","                selectedUser = context.selectedUser","            }","    }","}"]},{"level":3,"text":"Using Router Directly","type":"heading","anchor":"Using-Router-Directly"},{"inlineContent":[{"type":"text","text":"For ViewModel-driven architectures, register observers via "},{"code":"any RouterModel","type":"codeVoice"},{"type":"text","text":":"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["@MainActor","final class ParentViewModel: ObservableObject {","    private let router: any RouterModel","","    init(router: any RouterModel) {","        self.router = router","    }","","    func startObservingContext() {","        router.add(context: UserSelectionContext.self) { [weak self] context in","            self?.selectedUser = context.selectedUser","        }","    }","","    func stopObservingContext() {","        router.remove(context: UserSelectionContext.self)","    }","","    deinit {","        stopObservingContext()","    }","}"]},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"type":"text","text":"In views, prefer "},{"type":"codeVoice","code":".routerContext(...)"},{"type":"text","text":" for simple cases."},{"type":"text","text":" "},{"type":"text","text":"Use "},{"type":"codeVoice","code":"any RouterModel"},{"type":"text","text":" in ViewModels when context handling belongs to presentation\/business logic."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Warning: Use weak captures for class references (for example view models) to prevent retain cycles."}],"type":"paragraph"}]},{"level":2,"text":"Sending Context","type":"heading","anchor":"Sending-Context"},{"inlineContent":[{"text":"From a child route, send context using ","type":"text"},{"code":"context(_:)","type":"codeVoice"},{"text":" or ","type":"text"},{"code":"terminate(_:)","type":"codeVoice"},{"text":":","type":"text"}],"type":"paragraph"},{"level":3,"text":"context(_:) - Send Without Navigation","type":"heading","anchor":"context-Send-Without-Navigation"},{"inlineContent":[{"type":"text","text":"Sends the context to all observers without affecting navigation:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["struct UserPickerView: View {","    @Environment(\\.router) private var router","    let users: [User]","    ","    var body: some View {","        List(users) { user in","            Button(user.name) {","                \/\/ Send context but stay on this screen","                router.context(UserSelectionContext(selectedUser: user))","            }","        }","    }","}"]},{"level":3,"text":"terminate(_:) - Send and Complete Navigation","type":"heading","anchor":"terminate-Send-and-Complete-Navigation"},{"inlineContent":[{"text":"Sends the context, then completes navigation based on router state:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["struct UserPickerView: View {","    @Environment(\\.router) private var router","    let users: [User]","    ","    var body: some View {","        List(users) { user in","            Button(user.name) {","                \/\/ Send context and complete the current flow","                router.terminate(UserSelectionContext(selectedUser: user))","            }","        }","    }","}"]},{"inlineContent":[{"code":"terminate(_:)","type":"codeVoice"},{"type":"text","text":" will:"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Execute all matching context observers"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"If a matching local context anchor is found, pop back to that point in the current stack"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Otherwise, close the modal if the router is presented"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Otherwise, go back one step","type":"text"}]}]}]},{"level":2,"text":"Context Hierarchy","type":"heading","anchor":"Context-Hierarchy"},{"inlineContent":[{"text":"Contexts propagate up through the entire router hierarchy:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":null,"code":["App Router","    └── Tab Router","            └── Home Router (observer registered here)","                    └── List Router","                            └── Detail Router (context sent from here)"]},{"inlineContent":[{"type":"text","text":"When context is sent from Detail Router, it reaches the observer in Home Router."}],"type":"paragraph"},{"level":2,"text":"Removing Observers","type":"heading","anchor":"Removing-Observers"},{"inlineContent":[{"type":"text","text":"Observers are automatically removed when their route is popped. You can also remove them manually:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["router.remove(context: UserSelectionContext.self)"]},{"level":2,"text":"Common Patterns","type":"heading","anchor":"Common-Patterns"},{"level":3,"text":"Selection Flow","type":"heading","anchor":"Selection-Flow"},{"type":"codeListing","syntax":"swift","code":["\/\/ Parent: Start selection","router.push(HomeRoute.userPicker)","","\/\/ Parent: Receive selection",".routerContext(UserSelectionContext.self) { context in","    selectedUser = context.selectedUser","}","","\/\/ Child: Complete selection","router.terminate(UserSelectionContext(selectedUser: user))"]},{"level":3,"text":"Form Completion","type":"heading","anchor":"Form-Completion"},{"type":"codeListing","syntax":"swift","code":["\/\/ Parent",".routerContext(FormCompletionContext.self) { context in","    if context.success {","        showSuccessMessage()","    }","}","","\/\/ Child (form view)","func submitForm() async {","    let success = await api.submit(formData)","    router.terminate(FormCompletionContext(formData: formData, success: success))","}"]},{"level":3,"text":"Multi-Step Wizard","type":"heading","anchor":"Multi-Step-Wizard"},{"type":"codeListing","syntax":"swift","code":["struct WizardContext: RouteContext {","    let step: Int","    let data: WizardData","}","","\/\/ Each step sends progress","router.context(WizardContext(step: currentStep, data: collectedData))","","\/\/ Final step terminates","router.terminate(WizardContext(step: finalStep, data: completeData))"]},{"level":2,"text":"Memory Management","type":"heading","anchor":"Memory-Management"},{"inlineContent":[{"type":"text","text":"Context closures can cause retain cycles. Always use weak references:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["\/\/ ✅ Correct","router.add(context: MyContext.self) { [weak self] context in","    self?.handleContext(context)","}","","\/\/ ✅ Correct with view model",".routerContext(MyContext.self) { [weak viewModel] context in","    viewModel?.process(context)","}","","\/\/ ❌ Wrong for class references - causes retain cycle","router.add(context: MyContext.self) { context in","    self.handleContext(context)  \/\/ Strong reference to self","}"]}]}],"sections":[],"kind":"article","schemaVersion":{"major":0,"minor":3,"patch":0},"abstract":[{"text":"Learn how to pass data between routes using RouteContext.","type":"text"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/swiftrouting\/routecontextguide"]}],"references":{"doc://SwiftRouting/documentation/SwiftRouting/RouteContext":{"url":"\/documentation\/swiftrouting\/routecontext","title":"RouteContext","fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"RouteContext","kind":"identifier"}],"kind":"symbol","abstract":[{"text":"A type that can be used to pass data between routes and trigger navigation flow completions.","type":"text"}],"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContext","type":"topic","role":"symbol","navigatorTitle":[{"text":"RouteContext","kind":"identifier"}]},"doc://SwiftRouting/documentation/SwiftRouting":{"abstract":[{"text":"A lightweight, flexible navigation framework built on top of NavigationStack for SwiftUI.","type":"text"}],"type":"topic","url":"\/documentation\/swiftrouting","kind":"symbol","role":"collection","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting","title":"SwiftRouting"}}}