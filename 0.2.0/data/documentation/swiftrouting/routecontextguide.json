{"kind":"article","identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContextGuide"},"hierarchy":{"paths":[["doc:\/\/SwiftRouting\/documentation\/SwiftRouting"]]},"abstract":[{"type":"text","text":"Learn how to pass data between routes using RouteContext."}],"metadata":{"role":"article","roleHeading":"Article","title":"Route Context","modules":[{"name":"SwiftRouting"}]},"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"primaryContentSections":[{"content":[{"type":"heading","text":"Overview","level":2,"anchor":"Overview"},{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContext"},{"type":"text","text":" enables communication from child routes back to parent routes. Use it to pass selection results, form data, or completion signals up the navigation hierarchy."}]},{"type":"heading","text":"What is RouteContext?","level":2,"anchor":"What-is-RouteContext"},{"type":"paragraph","inlineContent":[{"text":"A ","type":"text"},{"type":"codeVoice","code":"RouteContext"},{"text":" is any type conforming to ","type":"text"},{"type":"codeVoice","code":"Hashable & Sendable"},{"text":". It acts as a message that can be sent from a child route and received by any ancestor route that registered an observer.","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["struct UserSelectionContext: RouteContext {","    let selectedUser: User","}","","struct FormCompletionContext: RouteContext {","    let formData: FormData","    let success: Bool","}"]},{"type":"heading","text":"Registering Context Observers","level":2,"anchor":"Registering-Context-Observers"},{"type":"heading","text":"Using the View Modifier","level":3,"anchor":"Using-the-View-Modifier"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The simplest way to observe contexts is with the "},{"type":"codeVoice","code":"routerContext"},{"type":"text","text":" modifier:"}]},{"syntax":"swift","type":"codeListing","code":["struct ParentView: View {","    @State private var selectedUser: User?","    ","    var body: some View {","        ContentView()","            .routerContext(UserSelectionContext.self) { context in","                selectedUser = context.selectedUser","            }","    }","}"]},{"type":"heading","text":"Using Router Directly","level":3,"anchor":"Using-Router-Directly"},{"type":"paragraph","inlineContent":[{"text":"For ViewModel-driven architectures, register observers via ","type":"text"},{"code":"any RouterModel","type":"codeVoice"},{"text":":","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["@MainActor","final class ParentViewModel: ObservableObject {","    private let router: any RouterModel","","    init(router: any RouterModel) {","        self.router = router","    }","","    func startObservingContext() {","        router.add(context: UserSelectionContext.self) { [weak self] context in","            self?.selectedUser = context.selectedUser","        }","    }","","    func stopObservingContext() {","        router.remove(context: UserSelectionContext.self)","    }","","    deinit {","        stopObservingContext()","    }","}"]},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"type":"text","text":"In views, prefer "},{"code":".routerContext(...)","type":"codeVoice"},{"type":"text","text":" for simple cases."},{"type":"text","text":" "},{"type":"text","text":"Use "},{"code":"any RouterModel","type":"codeVoice"},{"type":"text","text":" in ViewModels when context handling belongs to presentation\/business logic."}],"type":"paragraph"},{"inlineContent":[{"text":"Warning: Use weak captures for class references (for example view models) to prevent retain cycles.","type":"text"}],"type":"paragraph"}]},{"text":"Sending Context","type":"heading","anchor":"Sending-Context","level":2},{"type":"paragraph","inlineContent":[{"text":"From a child route, send context using ","type":"text"},{"code":"context(_:)","type":"codeVoice"},{"text":" or ","type":"text"},{"code":"terminate(_:)","type":"codeVoice"},{"text":":","type":"text"}]},{"text":"context(_:) - Send Without Navigation","type":"heading","anchor":"context-Send-Without-Navigation","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Sends the context to all observers without affecting navigation:"}]},{"syntax":"swift","type":"codeListing","code":["struct UserPickerView: View {","    @Environment(\\.router) private var router","    let users: [User]","    ","    var body: some View {","        List(users) { user in","            Button(user.name) {","                \/\/ Send context but stay on this screen","                router.context(UserSelectionContext(selectedUser: user))","            }","        }","    }","}"]},{"text":"terminate(_:) - Send and Complete Navigation","type":"heading","anchor":"terminate-Send-and-Complete-Navigation","level":3},{"type":"paragraph","inlineContent":[{"text":"Sends the context, then completes navigation based on router state:","type":"text"}]},{"syntax":"swift","type":"codeListing","code":["struct UserPickerView: View {","    @Environment(\\.router) private var router","    let users: [User]","    ","    var body: some View {","        List(users) { user in","            Button(user.name) {","                \/\/ Send context and complete the current flow","                router.terminate(UserSelectionContext(selectedUser: user))","            }","        }","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"terminate(_:)"},{"type":"text","text":" will:"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Execute all matching context observers"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"If a matching local context anchor is found, pop back to that point in the current stack"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Otherwise, close the modal if the router is presented","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Otherwise, go back one step","type":"text"}],"type":"paragraph"}]}],"type":"orderedList"},{"text":"Context Hierarchy","type":"heading","anchor":"Context-Hierarchy","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Contexts propagate up through the entire router hierarchy:"}]},{"syntax":null,"type":"codeListing","code":["App Router","    └── Tab Router","            └── Home Router (observer registered here)","                    └── List Router","                            └── Detail Router (context sent from here)"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"When context is sent from Detail Router, it reaches the observer in Home Router."}]},{"text":"Removing Observers","type":"heading","anchor":"Removing-Observers","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Observers are automatically removed when their route is popped. You can also remove them manually:"}]},{"syntax":"swift","type":"codeListing","code":["router.remove(context: UserSelectionContext.self)"]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"remove(context:)"},{"type":"text","text":" removes observers for that context type "},{"type":"strong","inlineContent":[{"text":"only on the current route","type":"text"}]},{"type":"text","text":"."}]},{"text":"Common Patterns","type":"heading","anchor":"Common-Patterns","level":2},{"text":"Selection Flow","type":"heading","anchor":"Selection-Flow","level":3},{"syntax":"swift","type":"codeListing","code":["\/\/ Parent: Start selection","router.push(HomeRoute.userPicker)","","\/\/ Parent: Receive selection",".routerContext(UserSelectionContext.self) { context in","    selectedUser = context.selectedUser","}","","\/\/ Child: Complete selection","router.terminate(UserSelectionContext(selectedUser: user))"]},{"text":"Form Completion","type":"heading","anchor":"Form-Completion","level":3},{"syntax":"swift","type":"codeListing","code":["\/\/ Parent",".routerContext(FormCompletionContext.self) { context in","    if context.success {","        showSuccessMessage()","    }","}","","\/\/ Child (form view)","func submitForm() async {","    let success = await api.submit(formData)","    router.terminate(FormCompletionContext(formData: formData, success: success))","}"]},{"text":"Multi-Step Wizard","type":"heading","anchor":"Multi-Step-Wizard","level":3},{"syntax":"swift","type":"codeListing","code":["struct WizardContext: RouteContext {","    let step: Int","    let data: WizardData","}","","\/\/ Each step sends progress","router.context(WizardContext(step: currentStep, data: collectedData))","","\/\/ Final step terminates","router.terminate(WizardContext(step: finalStep, data: completeData))"]},{"text":"Memory Management","type":"heading","anchor":"Memory-Management","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Context closures can cause retain cycles. Always use weak references:"}]},{"syntax":"swift","type":"codeListing","code":["\/\/ ✅ Correct","router.add(context: MyContext.self) { [weak self] context in","    self?.handleContext(context)","}","","\/\/ ✅ Correct with view model",".routerContext(MyContext.self) { [weak viewModel] context in","    viewModel?.process(context)","}","","\/\/ ❌ Wrong for class references - causes retain cycle","router.add(context: MyContext.self) { context in","    self.handleContext(context)  \/\/ Strong reference to self","}"]}],"kind":"content"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/swiftrouting\/routecontextguide"]}],"references":{"doc://SwiftRouting/documentation/SwiftRouting/RouteContext":{"fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"RouteContext","kind":"identifier"}],"navigatorTitle":[{"text":"RouteContext","kind":"identifier"}],"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouteContext","abstract":[{"text":"A type that can be used to pass data between routes and trigger navigation flow completions.","type":"text"}],"title":"RouteContext","role":"symbol","type":"topic","kind":"symbol","url":"\/documentation\/swiftrouting\/routecontext"},"doc://SwiftRouting/documentation/SwiftRouting":{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting","abstract":[{"text":"A lightweight, type-safe navigation framework built on top of NavigationStack for SwiftUI.","type":"text"}],"role":"collection","kind":"symbol","type":"topic","url":"\/documentation\/swiftrouting","title":"SwiftRouting"}}}