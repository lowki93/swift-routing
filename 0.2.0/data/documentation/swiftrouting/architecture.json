{"metadata":{"title":"Architecture","roleHeading":"API Collection","role":"collectionGroup","modules":[{"name":"SwiftRouting"}]},"kind":"article","abstract":[{"type":"text","text":"Understand the design principles and structure behind SwiftRouting."}],"seeAlsoSections":[{"identifiers":["doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Testing"],"title":"Architecture and Testing","anchor":"Architecture-and-Testing","generated":true}],"topicSections":[{"identifiers":["doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouterModel","doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/TabRouter","doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RoutingView"],"title":"Related","anchor":"Related"}],"primaryContentSections":[{"content":[{"anchor":"Overview","text":"Overview","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"SwiftRouting is built around a few core principles: "},{"type":"strong","inlineContent":[{"type":"text","text":"separation of concerns"}]},{"type":"text","text":", "},{"type":"strong","inlineContent":[{"text":"type safety","type":"text"}]},{"type":"text","text":", and "},{"type":"strong","inlineContent":[{"text":"testability","type":"text"}]},{"type":"text","text":". This guide explains how these principles shape the framework’s architecture."}],"type":"paragraph"},{"anchor":"Design-Principles","text":"Design Principles","type":"heading","level":2},{"anchor":"Routes-Are-Data-Not-Views","text":"Routes Are Data, Not Views","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"In SwiftRouting, routes are simple Swift enums that describe "},{"type":"emphasis","inlineContent":[{"type":"text","text":"what"}]},{"type":"text","text":" destination to navigate to, not "},{"type":"emphasis","inlineContent":[{"text":"how","type":"text"}]},{"type":"text","text":" to display it:"}],"type":"paragraph"},{"syntax":"swift","code":["enum AppRoute: Route {","    case home","    case profile(userId: String)","    case settings","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"The view mapping is handled separately through "},{"type":"codeVoice","code":"RouteDestination"},{"type":"text","text":":"}],"type":"paragraph"},{"syntax":"swift","code":["extension AppRoute: RouteDestination {","    static func view(for route: AppRoute) -> some View {","        switch route {","        case .home: HomeView()","        case .profile(let userId): ProfileView(userId: userId)","        case .settings: SettingsView()","        }","    }","}"],"type":"codeListing"},{"inlineContent":[{"inlineContent":[{"text":"Why this separation?","type":"text"}],"type":"strong"}],"type":"paragraph"},{"header":"row","type":"table","rows":[[[{"inlineContent":[{"text":"Benefit","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Explanation"}]}]],[[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Reusability","type":"text"}],"type":"strong"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Routes can be used in navigation, deep links, analytics, and tests without view dependencies"}]}]],[[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Testability"}],"type":"strong"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Test navigation logic by asserting on route values, not view hierarchies"}]}]],[[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Flexibility","type":"text"}],"type":"strong"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Change view implementations without touching route definitions"}]}]],[[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Modularity"}],"type":"strong"}]}],[{"type":"paragraph","inlineContent":[{"text":"Routes can live in a shared module; views in feature modules","type":"text"}]}]]]},{"anchor":"Protocol-Based-Router","text":"Protocol-Based Router","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"The "},{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","isActive":true,"type":"reference"},{"type":"text","text":" class implements the "},{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouterModel","isActive":true,"type":"reference"},{"type":"text","text":" protocol, which defines all navigation operations:"}],"type":"paragraph"},{"syntax":"swift","code":["public protocol RouterModel {","    func push(_ route: some Route)","    func present(_ route: some Route, withStack: Bool)","    func cover(_ route: some Route)","    func back()","    func popToRoot()","    func close()","    \/\/ ...","}"],"type":"codeListing"},{"inlineContent":[{"text":"This protocol-based design enables:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Dependency injection","type":"text"}],"type":"strong"},{"text":" in ViewModels","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Mocking"}],"type":"strong"},{"text":" for unit tests","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Abstraction"}]},{"type":"text","text":" over concrete router implementations"}],"type":"paragraph"}]}]},{"anchor":"Hierarchical-Router-Structure","text":"Hierarchical Router Structure","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"SwiftRouting creates a hierarchy of routers that mirrors your navigation structure:"}],"type":"paragraph"},{"syntax":null,"code":["App","└── TabRouter (manages tab selection)","    ├── Router [Home Tab]","    │   └── Router [Presented Sheet]","    ├── Router [Search Tab]","    └── Router [Profile Tab]"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Each "},{"isActive":true,"type":"reference","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RoutingView"},{"type":"text","text":" creates its own "},{"isActive":true,"type":"reference","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router"},{"type":"text","text":". When you present a sheet or cover, a new child router is created. This hierarchy enables:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Scoped navigation"}]},{"type":"text","text":": Each router manages its own stack"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Context propagation","type":"text"}]},{"type":"text","text":": "},{"code":"RouteContext","type":"codeVoice"},{"type":"text","text":" flows up through the hierarchy"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Coordinated dismissal"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"closeChildren()"},{"type":"text","text":" dismisses all descendants"}],"type":"paragraph"}]}]},{"anchor":"Component-Relationships","text":"Component Relationships","type":"heading","level":2},{"anchor":"RoutingView","text":"RoutingView","type":"heading","level":3},{"inlineContent":[{"type":"reference","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RoutingView","isActive":true},{"type":"text","text":" is the entry point that creates a "},{"type":"codeVoice","code":"NavigationStack"},{"type":"text","text":" with an associated "},{"type":"reference","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","isActive":true},{"type":"text","text":":"}],"type":"paragraph"},{"syntax":"swift","code":["RoutingView(destination: AppRoute.self, root: .home)"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"It:"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"text":"Creates a ","type":"text"},{"isActive":true,"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","type":"reference"},{"text":" instance","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Injects it into the environment via ","type":"text"},{"type":"codeVoice","code":"@Environment(\\.router)"}]}]},{"content":[{"inlineContent":[{"text":"Registers the ","type":"text"},{"type":"codeVoice","code":"RouteDestination"},{"text":" for navigation","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Manages sheet and cover presentations","type":"text"}],"type":"paragraph"}]}]},{"anchor":"Router","text":"Router","type":"heading","level":3},{"inlineContent":[{"text":"The ","type":"text"},{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","type":"reference","isActive":true},{"text":" manages:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Navigation path","type":"text"}]},{"type":"text","text":": The stack of pushed routes"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Root route"}]},{"type":"text","text":": The initial route displayed"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Presentations"}]},{"text":": Sheet and cover modals","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Context observers"}],"type":"strong"},{"text":": Registered ","type":"text"},{"code":"RouteContext","type":"codeVoice"},{"text":" handlers","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Child routers"}]},{"type":"text","text":": Routers created by presented modals"}]}]}]},{"anchor":"TabRouter","text":"TabRouter","type":"heading","level":3},{"inlineContent":[{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/TabRouter","type":"reference","isActive":true},{"type":"text","text":" coordinates navigation across tabs:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Manages the selected tab"}]}]},{"content":[{"inlineContent":[{"text":"Provides access to each tab’s ","type":"text"},{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","isActive":true,"type":"reference"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Enables cross-tab navigation ("},{"type":"codeVoice","code":"push(_:in:)"},{"type":"text","text":", "},{"type":"codeVoice","code":"popToRoot(in:)"},{"type":"text","text":")"}]}]},{"content":[{"inlineContent":[{"text":"Handles tab-aware deep links","type":"text"}],"type":"paragraph"}]}]},{"anchor":"Data-Flow","text":"Data Flow","type":"heading","level":2},{"anchor":"Navigation-Flow","text":"Navigation Flow","type":"heading","level":3},{"syntax":null,"code":["User Action → Router Method → State Update → SwiftUI Renders","     │              │              │","     │              │              └── @Published properties trigger view updates","     │              └── push(), present(), back(), etc.","     └── Button tap, deep link, programmatic call"],"type":"codeListing"},{"anchor":"Context-Flow","text":"Context Flow","type":"heading","level":3},{"inlineContent":[{"code":"RouteContext","type":"codeVoice"},{"text":" flows upward through the router hierarchy:","type":"text"}],"type":"paragraph"},{"syntax":null,"code":["Child Router                    Parent Router","     │                               │","     │ router.terminate(context) ────▶│ .routerContext handler executes","     │                               │","     │◀──── Navigation completes ────│"],"type":"codeListing"},{"anchor":"Deep-Link-Flow","text":"Deep Link Flow","type":"heading","level":3},{"syntax":null,"code":["URL\/Identifier → DeeplinkHandler → DeeplinkRoute → Router.handle(deeplink:)","                      │                  │                   │","                      │                  │                   └── Executes navigation sequence","                      │                  └── Factory creates navigation instructions","                      └── Async conversion with optional data fetching"],"type":"codeListing"},{"anchor":"Memory-Management","text":"Memory Management","type":"heading","level":2},{"anchor":"Router-Lifecycle","text":"Router Lifecycle","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"Routers are retained by their parent "},{"type":"codeVoice","code":"RoutingView"},{"type":"text","text":". When a view is dismissed:"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"text":"The router is deallocated","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Context observers are automatically cleaned up"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Child routers are released"}]}]}]},{"anchor":"Context-Cleanup","text":"Context Cleanup","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"Context observers registered on a route are automatically removed when that route is popped from the stack. This prevents memory leaks and stale callbacks."}],"type":"paragraph"},{"syntax":"swift","code":["\/\/ Observer registered on .list route","router.push(.list)","router.add(context: SelectionContext.self) { ... }","","\/\/ When .list is popped, the observer is automatically removed","router.back()"],"type":"codeListing"},{"anchor":"Best-Practices","text":"Best Practices","type":"heading","level":2},{"anchor":"Keep-Routes-Focused","text":"Keep Routes Focused","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"One route enum per feature or navigation context:"}],"type":"paragraph"},{"syntax":"swift","code":["\/\/ Good: Focused route enums","enum HomeRoute: Route { ... }","enum ProfileRoute: Route { ... }","enum SettingsRoute: Route { ... }","","\/\/ Avoid: One massive enum for everything","enum AppRoute: Route {","    case home, homeDetail, homeSettings, profile, profileEdit, ...","}"],"type":"codeListing"},{"anchor":"Use-Nested-Routes-for-Complex-Hierarchies","text":"Use Nested Routes for Complex Hierarchies","type":"heading","level":3},{"syntax":"swift","code":["enum AppRoute: Route {","    case home","    case profile(ProfileRoute)","    case settings(SettingsRoute)","}"],"type":"codeListing"},{"anchor":"Inject-RouterModel-Not-Router","text":"Inject RouterModel, Not Router","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"In ViewModels, depend on the protocol for testability:"}],"type":"paragraph"},{"syntax":"swift","code":["class MyViewModel {","    private let router: any RouterModel","    ","    init(router: any RouterModel) {","        self.router = router","    }","}"],"type":"codeListing"},{"anchor":"Prefer-terminate-Over-Manual-Navigation","text":"Prefer terminate() Over Manual Navigation","type":"heading","level":3},{"inlineContent":[{"text":"When completing a flow with context, use ","type":"text"},{"type":"codeVoice","code":"terminate()"},{"text":" instead of manual ","type":"text"},{"type":"codeVoice","code":"back()"},{"text":" or ","type":"text"},{"type":"codeVoice","code":"close()"},{"text":":","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["\/\/ Good: Let the framework handle navigation","router.terminate(SelectionContext(item: selectedItem))","","\/\/ Avoid: Manual navigation after context","router.context(SelectionContext(item: selectedItem))","router.back() \/\/ or router.close()"],"type":"codeListing"}],"kind":"content"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/swiftrouting\/architecture"]}],"sections":[],"schemaVersion":{"major":0,"minor":3,"patch":0},"hierarchy":{"paths":[["doc:\/\/SwiftRouting\/documentation\/SwiftRouting"]]},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Architecture"},"references":{"doc://SwiftRouting/documentation/SwiftRouting/RoutingView":{"fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"RoutingView","kind":"identifier"}],"navigatorTitle":[{"text":"RoutingView","kind":"identifier"}],"abstract":[{"text":"Creates a navigation container with its own ","type":"text"},{"code":"Router","type":"codeVoice"},{"text":".","type":"text"}],"role":"symbol","title":"RoutingView","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RoutingView","url":"\/documentation\/swiftrouting\/routingview","kind":"symbol","type":"topic"},"doc://SwiftRouting/documentation/SwiftRouting/TabRouter":{"role":"symbol","navigatorTitle":[{"kind":"identifier","text":"TabRouter"}],"type":"topic","kind":"symbol","url":"\/documentation\/swiftrouting\/tabrouter","abstract":[{"type":"text","text":"A router managing navigation within a "},{"type":"codeVoice","code":"RoutingTabView"},{"type":"text","text":"."}],"title":"TabRouter","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"TabRouter"}],"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/TabRouter"},"doc://SwiftRouting/documentation/SwiftRouting/Testing":{"type":"topic","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Testing","abstract":[{"text":"Learn how to write unit tests for your navigation logic.","type":"text"}],"title":"Testing Navigation","url":"\/documentation\/swiftrouting\/testing","role":"collectionGroup","kind":"article"},"doc://SwiftRouting/documentation/SwiftRouting/RouterModel":{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/RouterModel","url":"\/documentation\/swiftrouting\/routermodel","type":"topic","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"RouterModel"}],"abstract":[{"type":"text","text":"Defines navigation capabilities within a "},{"code":"ViewModel","type":"codeVoice"},{"type":"text","text":" or other components."}],"title":"RouterModel","role":"symbol","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"RouterModel"}]},"doc://SwiftRouting/documentation/SwiftRouting":{"identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting","abstract":[{"text":"A lightweight, type-safe navigation framework built on top of NavigationStack for SwiftUI.","type":"text"}],"role":"collection","kind":"symbol","type":"topic","url":"\/documentation\/swiftrouting","title":"SwiftRouting"},"doc://SwiftRouting/documentation/SwiftRouting/Router":{"role":"symbol","abstract":[{"type":"text","text":"Every "},{"type":"codeVoice","code":"RoutingView"},{"type":"text","text":" has his own router"}],"kind":"symbol","identifier":"doc:\/\/SwiftRouting\/documentation\/SwiftRouting\/Router","navigatorTitle":[{"text":"Router","kind":"identifier"}],"title":"Router","type":"topic","url":"\/documentation\/swiftrouting\/router","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"Router","kind":"identifier"}]}}}